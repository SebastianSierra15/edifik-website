{
  "app": {
    "admin": {
      "propiedades": {
        "page.tsx": "\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { useProperties } from \"@/app/hooks/useProperties\";\r\nimport PropertyFilter from \"@/app/ui/properties/propertyFilter\";\r\nimport PropertyCard from \"@/app/ui/properties/propertyCard\";\r\nimport FilterMapControls from \"@/app/ui/properties/filterMapControls\";\r\nimport PropertiesMap from \"@/app/ui/properties/propertiesMap\";\r\nimport {\r\n  FaGlobe,\r\n  FaHome,\r\n  FaClipboardList,\r\n  FaBuilding,\r\n  FaSearch,\r\n  FaPlus,\r\n} from \"react-icons/fa\";\r\nimport Link from \"next/link\";\r\n\r\nconst categoryButtons = [\r\n  { id: \"\", label: \"Todas\", icon: FaGlobe },\r\n  { id: \"1002\", label: \"Venta\", icon: FaHome },\r\n  { id: \"1003\", label: \"Sobre Planos\", icon: FaClipboardList },\r\n  { id: \"1004\", label: \"Arriendo\", icon: FaBuilding },\r\n];\r\n\r\nexport default function PropertiesPage() {\r\n  const [selectedButtons, setSelectedButtons] = useState<\r\n    Record<string, number[]>\r\n  >({\r\n    cities: [],\r\n    propertyTypes: [],\r\n    housingTypes: [],\r\n    commonAreas: [],\r\n    nearbyServices: [],\r\n    memberships: [],\r\n    rooms: [1],\r\n    bathrooms: [1],\r\n    lobbies: [1],\r\n    price: [1],\r\n    area: [1],\r\n  });\r\n\r\n  const [priceRange, setPriceRange] = useState<{ min: number; max: number }>({\r\n    min: 0,\r\n    max: 0,\r\n  });\r\n  const [areaRange, setAreaRange] = useState<{ min: number; max: number }>({\r\n    min: 0,\r\n    max: 0,\r\n  });\r\n\r\n  const [selectedCategory, setSelectedCategory] = useState(\"1002,1003,1004\");\r\n  const [entriesPerPage, setEntriesPerPage] = useState(15);\r\n  const [filterOpen, setFilterOpen] = useState(false);\r\n  const [showMap, setShowMap] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n\r\n  const mapRef = useRef<HTMLDivElement>(null);\r\n\r\n  const {\r\n    properties,\r\n    totalEntries,\r\n    fetchMoreProperties,\r\n    debouncedSearch,\r\n    resetProperties,\r\n  } = useProperties({\r\n    entriesPerPage,\r\n    selectedCategory,\r\n    selectedButtons,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const ranges: Record<\r\n      string,\r\n      {\r\n        price: { min: number; max: number };\r\n        area: { min: number; max: number };\r\n      }\r\n    > = {\r\n      \"1002\": {\r\n        price: { min: 0, max: 2500000000 },\r\n        area: { min: 0, max: 5000 },\r\n      },\r\n      \"1003\": {\r\n        price: { min: 0, max: 2500000000 },\r\n        area: { min: 0, max: 2000 },\r\n      },\r\n      \"1004\": { price: { min: 0, max: 10000000 }, area: { min: 0, max: 1000 } },\r\n      default: {\r\n        price: { min: 0, max: 2500000000 },\r\n        area: { min: 0, max: 5000 },\r\n      },\r\n    };\r\n\r\n    const { price, area } =\r\n      ranges[selectedCategory as keyof typeof ranges] || ranges.default;\r\n\r\n    setPriceRange(price);\r\n    setAreaRange(area);\r\n\r\n    setSelectedButtons((prev) => ({ ...prev, price: [], area: [] }));\r\n  }, [selectedCategory]);\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      {/* Header */}\r\n      <div className=\"bg-backgroundDark dark:bg-darkBackgroundLight px-6 pt-6 pb-2\">\r\n        <h1 className=\"mt-24 text-3xl text-center font-semibold mb-10 text-primary dark:text-primaryLight\">\r\n          Gestión de Propiedades\r\n        </h1>\r\n\r\n        {/* Botones de categorías */}\r\n        <div\r\n          className={`flex flex-wrap justify-center items-center gap-4 ${\r\n            showMap ? \"mb-0\" : \"mb-6\"\r\n          }`}\r\n          ref={mapRef}\r\n        >\r\n          {categoryButtons.map(({ id, label, icon: Icon }) => (\r\n            <button\r\n              key={id}\r\n              onClick={() => setSelectedCategory(id)}\r\n              className={`flex items-center space-x-2 px-4 py-2 rounded-lg shadow-md transition-colors ${\r\n                selectedCategory === id\r\n                  ? \"bg-primary dark:bg-primary hover:bg-primaryDark text-white\"\r\n                  : \"bg-white dark:bg-darkBackgroundLight text-primary dark:text-primaryLight hover:bg-backgroundDark dark:hover:bg-darkBackground\"\r\n              }`}\r\n            >\r\n              <Icon />\r\n              <span>{label}</span>\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Barra de búsqueda, botón Nueva Propiedad y botón de Membresías */}\r\n        <div\r\n          className={`flex flex-col md:flex-row md:justify-between items-center gap-8 mb-10 px-6 ${\r\n            showMap ? \"hidden\" : \"block\"\r\n          }`}\r\n        >\r\n          <div className=\"relative w-full\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Buscar propiedades...\"\r\n              onChange={(e) => debouncedSearch(e.target.value)}\r\n              className=\"p-2 pl-10 border border-borderColor dark:border-borderColor focus:border-borderColorHover dark:focus:border-borderColorHover rounded-md w-full bg-white dark:bg-darkBackgroundLight text-textPrimary dark:text-darkTextPrimary\"\r\n            />\r\n            <FaSearch className=\"absolute left-3 top-3 text-gray-400 dark:text-darkTextSecondary\" />\r\n          </div>\r\n\r\n          <div className=\"flex flex-col gap-4 sm:flex-row items-center\">\r\n            <Link href=\"/admin/propiedades/membresias\" passHref>\r\n              <button className=\"flex items-center space-x-2 px-6 py-2 rounded-lg shadow-md bg-primary dark:bg-primary text-white hover:bg-primaryDark dark:hover:bg-primaryDark transition-colors whitespace-nowrap\">\r\n                <span>Membresías</span>\r\n              </button>\r\n            </Link>\r\n\r\n            <Link href=\"/admin/propiedades/crearPropiedad\">\r\n              <button className=\"flex items-center space-x-2 px-6 py-2 rounded-lg shadow-md bg-green-600 dark:bg-green-700 text-white hover:bg-green-700 dark:hover:bg-green-800 transition-colors whitespace-nowrap\">\r\n                <FaPlus />\r\n                <span>Nueva Propiedad</span>\r\n              </button>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <hr\r\n        className={`border-borderColor dark:border-darkBorderColor w-full ${\r\n          showMap ? \"hidden\" : \"block\"\r\n        }`}\r\n      />\r\n\r\n      <div\r\n        className={`bg-backgroundDark dark:bg-darkBackgroundLight px-6 pt-2 ${\r\n          showMap ? \"pb-2\" : \"pb-14\"\r\n        }`}\r\n      >\r\n        <FilterMapControls\r\n          filterOpen={filterOpen}\r\n          setFilterOpen={setFilterOpen}\r\n          showMap={showMap}\r\n          setShowMap={setShowMap}\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        {showMap ? (\r\n          <div\r\n            className=\"relative z-0 border-t border-t-gray-500\"\r\n            style={{\r\n              height: showMap ? \"calc(100vh - 160px)\" : \"calc(100vh - 86px)\",\r\n            }}\r\n          >\r\n            <PropertiesMap properties={properties} />\r\n          </div>\r\n        ) : (\r\n          <div className=\"-mt-10 mb-10 flex flex-col sm:flex-row sm:justify-between gap-4 sm:gap-4 md:gap-8 py-4 px-6 lg:px-8 xl:px-20\">\r\n            {/* Sidebar de filtros */}\r\n            {!showMap && (\r\n              <div\r\n                className={`flex flex-col items-center w-full sm:px-10 sm:w-72 ${\r\n                  filterOpen ? \"block\" : \"hidden\"\r\n                }`}\r\n              >\r\n                <PropertyFilter\r\n                  selectedButtons={selectedButtons}\r\n                  setSelectedButtons={setSelectedButtons}\r\n                  setFilterOpen={setFilterOpen}\r\n                  priceRange={priceRange}\r\n                  areaRange={areaRange}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Mostrar propiedades */}\r\n            <div className=\"flex flex-col w-full\">\r\n              <div\r\n                className={`grid gap-x-4 gap-y-6 mb-8 ${\r\n                  filterOpen\r\n                    ? \"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4\"\r\n                    : \"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 2xl:grid-cols-5\"\r\n                }`}\r\n              >\r\n                {properties.map((property) => (\r\n                  <div\r\n                    key={property.id}\r\n                    className=\"flex justify-center items-center relative\"\r\n                  >\r\n                    <div className=\"w-full max-w-xs\">\r\n                      <PropertyCard\r\n                        key={property.id}\r\n                        images={[\r\n                          \"/images/image2.jpg\",\r\n                          \"/images/image3.jpg\",\r\n                          \"/images/image4.jpg\",\r\n                        ]}\r\n                        name={property.name}\r\n                        location={`${property.city.name}, ${property.city.departament.name}`}\r\n                        price={property.price}\r\n                        area={property.area}\r\n                        idMembership={property.membership}\r\n                        isFromMap={false}\r\n                        showActions={true}\r\n                        onClose={null}\r\n                        url={`/admin/propiedades/${property.id}`}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Botón Mostrar Más */}\r\n              {Math.ceil(totalEntries / entriesPerPage) >\r\n                properties.length / entriesPerPage && (\r\n                <button\r\n                  onClick={fetchMoreProperties}\r\n                  className=\"mt-6 px-6 py-2 rounded-lg shadow-lg bg-primary dark:bg-primary text-white hover:bg-primaryDark dark:hover:bg-primaryDark transition-colors self-center\"\r\n                >\r\n                  Mostrar más\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"
      }
    },
    "hooks": {
      "useProperties.ts": "\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { PropertySummary } from \"@/lib/definitios\";\r\nimport { useDebouncedCallback } from \"use-debounce\";\r\n\r\ninterface UsePropertiesOptions {\r\n  entriesPerPage: number;\r\n  selectedCategory: string;\r\n  selectedButtons: Record<string, number[]>;\r\n}\r\n\r\nexport function useProperties({\r\n  entriesPerPage,\r\n  selectedCategory,\r\n  selectedButtons,\r\n}: UsePropertiesOptions) {\r\n  const [properties, setProperties] = useState<PropertySummary[]>([]);\r\n  const [totalEntries, setTotalEntries] = useState(0);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const debouncedSearch = useDebouncedCallback((term: string) => {\r\n    setSearchTerm(term);\r\n    resetProperties();\r\n  }, 300);\r\n\r\n  const resetProperties = () => {\r\n    setProperties([]);\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const fetchProperties = async (isLoadMore = false) => {\r\n    if (isLoading) return;\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const params = {\r\n        page: currentPage,\r\n        pageSize: entriesPerPage,\r\n        searchTerm,\r\n        categories: selectedCategory,\r\n        ...Object.fromEntries(\r\n          Object.entries(selectedButtons).map(([key, value]) => [\r\n            key,\r\n            value.join(\",\"),\r\n          ])\r\n        ),\r\n      };\r\n\r\n      const response = await axios.get(\"/api/properties\", { params });\r\n      const newProperties: PropertySummary[] = response.data.properties;\r\n\r\n      setProperties((prev) =>\r\n        isLoadMore\r\n          ? [\r\n              ...prev,\r\n              ...newProperties.filter(\r\n                (p) => !prev.some((prop) => prop.id === p.id)\r\n              ),\r\n            ]\r\n          : newProperties\r\n      );\r\n      setTotalEntries(response.data.totalEntries);\r\n    } catch (error) {\r\n      console.error(\"Error fetching properties:\", error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProperties();\r\n  }, [currentPage, searchTerm, selectedCategory, selectedButtons]);\r\n\r\n  const fetchMoreProperties = () => {\r\n    setCurrentPage((prevPage) => prevPage + 1);\r\n  };\r\n\r\n  return {\r\n    properties,\r\n    totalEntries,\r\n    fetchMoreProperties,\r\n    debouncedSearch,\r\n    resetProperties,\r\n    isLoading,\r\n  };\r\n}\r\n"
    }
  }
}