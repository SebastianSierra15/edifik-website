{
  "app": {
    "ui": {
      "projects": {
        "createEditProject": {
          "imagesProjectForm.tsx": "\"use client\";\n\nimport { useState, ChangeEvent, useEffect, useCallback, useMemo } from \"react\";\nimport { ProjectData, ImageType, Media } from \"@/lib/definitios\";\nimport { useImagesProjectValidation } from \"@/app/hooks/projects/createEditProject/useImagesProjectValidation\";\nimport ImageUploadSection from \"./ImageUploadSection\";\nimport StepNavigationButtons from \"../../admin/stepNavigationButtons\";\nimport ModalAlert from \"../../modals/modalAlert\";\n\ninterface UploadImagesFormProps {\n  formData: ProjectData;\n  onChange: (updatedData: Partial<ProjectData>) => void;\n  onPrevious: () => void;\n  onNext: () => void;\n  currentStep: number;\n  totalSteps: number;\n  imagesTypes: ImageType[];\n  onSubmit: (media: Media[]) => void;\n  imageData: {\n    images: Record<string, File[]>;\n    imageTags: Record<string, string[]>;\n    imageDescriptions: Record<string, string[]>;\n  };\n  setImageData: React.Dispatch<\n    React.SetStateAction<{\n      images: Record<string, File[]>;\n      imageTags: Record<string, string[]>;\n      imageDescriptions: Record<string, string[]>;\n    }>\n  >;\n}\n\nexport default function ImagesProjectForm({\n  formData,\n  onPrevious,\n  onNext,\n  currentStep,\n  totalSteps,\n  imagesTypes,\n  onSubmit,\n  imageData,\n  setImageData,\n}: UploadImagesFormProps) {\n  const images = imageData.images;\n  const imageTags = imageData.imageTags;\n  const imageDescriptions = imageData.imageDescriptions;\n\n  const { errors, validateFields, validateField } = useImagesProjectValidation(\n    formData,\n    images,\n    imageTags,\n    imageDescriptions,\n    imagesTypes\n  );\n\n  const [expandedSections, setExpandedSections] = useState<\n    Record<string, boolean>\n  >({});\n  const [showAlert, setShowAlert] = useState(false);\n  const [alertMessage, setAlertMessage] = useState(\"\");\n\n  useEffect(() => {\n    console.log(\n      \"üîÑ imageData actualizado en ImagesProjectForm:\",\n      JSON.stringify(imageData, null, 2)\n    );\n  }, [imageData]);\n\n  useEffect(() => {\n    setExpandedSections(\n      imagesTypes.reduce((acc, item) => ({ ...acc, [item.name]: false }), {})\n    );\n  }, [imagesTypes]);\n\n  const toggleSection = useCallback((category: string) => {\n    setExpandedSections((prev) => ({ ...prev, [category]: !prev[category] }));\n  }, []);\n\n  const handleImageChange = useCallback(\n    (\n      category: string,\n      event: ChangeEvent<HTMLInputElement>,\n      maxImages: number\n    ) => {\n      if (!event.target.files || event.target.files.length === 0) {\n        console.warn(\n          \"No se seleccionaron archivos o event.target.files es null.\"\n        );\n        return;\n      }\n\n      const maxFileSize = 1 * 1024 * 1024;\n      const selectedFiles = Array.from(event.target.files); // Convertir FileList a array\n\n      console.log(`Archivos seleccionados para ${category}:`, selectedFiles);\n\n      const validFiles: File[] = selectedFiles.filter(\n        (file) => file.size <= maxFileSize\n      );\n      const invalidFiles = selectedFiles.filter(\n        (file) => file.size > maxFileSize\n      );\n\n      if (invalidFiles.length > 0) {\n        setAlertMessage(\n          \"Algunas im√°genes superan el l√≠mite de tama√±o de 1MB y no se cargar√°n.\"\n        );\n        setShowAlert(true);\n      }\n\n      setImageData((prev) => {\n        const updatedImages = [...(prev.images[category] || []), ...validFiles];\n\n        return {\n          ...prev,\n          images: { ...prev.images, [category]: updatedImages },\n          imageTags: {\n            ...prev.imageTags,\n            [category]: [\n              ...(prev.imageTags[category] || []),\n              ...validFiles.map(() => \"\"),\n            ],\n          },\n          imageDescriptions: {\n            ...prev.imageDescriptions,\n            [category]: [\n              ...(prev.imageDescriptions[category] || []),\n              ...validFiles.map(() => \"\"),\n            ],\n          },\n        };\n      });\n\n      console.log(\n        `‚úÖ Nuevo estado de imageData despu√©s de actualizar ${category}:`,\n        JSON.stringify(imageData, null, 2)\n      );\n\n      event.target.value = \"\"; // Limpiar input despu√©s de seleccionar\n    },\n    [setImageData]\n  );\n\n  const handleRemoveImage = useCallback(\n    (category: string, index: number) => {\n      setImageData((prev) => ({\n        ...prev,\n        images: {\n          ...prev.images,\n          [category]:\n            prev.images[category]?.filter((_, i) => i !== index) || [],\n        },\n        imageTags: {\n          ...prev.imageTags,\n          [category]:\n            prev.imageTags[category]?.filter((_, i) => i !== index) || [],\n        },\n        imageDescriptions: {\n          ...prev.imageDescriptions,\n          [category]:\n            prev.imageDescriptions[category]?.filter((_, i) => i !== index) ||\n            [],\n        },\n      }));\n    },\n    [setImageData]\n  );\n\n  const handleTagChange = useCallback(\n    (category: string, index: number, tag: string) => {\n      setImageData((prev) => ({\n        ...prev,\n        imageTags: {\n          ...prev.imageTags,\n          [category]:\n            prev.imageTags[category]?.map((t, i) => (i === index ? tag : t)) ||\n            [],\n        },\n      }));\n\n      validateField(`${category}-tag-${index}`, tag);\n    },\n    [setImageData, validateField]\n  );\n\n  const handleDescriptionChange = useCallback(\n    (category: string, index: number, description: string) => {\n      setImageData((prev) => ({\n        ...prev,\n        imageDescriptions: {\n          ...prev.imageDescriptions,\n          [category]:\n            prev.imageDescriptions[category]?.map((d, i) =>\n              i === index ? description : d\n            ) || [],\n        },\n      }));\n\n      validateField(`${category}-description-${index}`, description);\n    },\n    [setImageData, validateField]\n  );\n\n  const handleSubmit = useCallback(() => {\n    if (validateFields()) {\n      const mediaData: Media[] = Object.entries(images).flatMap(\n        ([type, files]) => {\n          const imageType = imagesTypes.find(\n            (imgType) => imgType.name === type\n          );\n          const commonArea = formData.commonAreas?.find(\n            (area) => area.name === type\n          );\n\n          return files.map((file, index) => ({\n            tag: imageTags[type][index] || \"\",\n            file,\n            description: imageDescriptions[type]?.[index] || \"\",\n            idType: imageType ? imageType.id : commonArea?.id || 0,\n            type: type,\n            category: imageType ? \"imageType\" : \"commonArea\",\n          }));\n        }\n      );\n\n      onSubmit(mediaData);\n      onNext();\n    }\n  }, [\n    validateFields,\n    images,\n    imageTags,\n    imageDescriptions,\n    imagesTypes,\n    formData.commonAreas,\n    onSubmit,\n    onNext,\n  ]);\n\n  return (\n    <div className=\"container mx-auto w-full rounded-lg bg-premium-backgroundLight p-6 shadow-lg dark:bg-premium-backgroundDark space-y-3\">\n      <h2 className=\"mb-6 text-center text-2xl font-bold text-premium-primary dark:text-premium-primaryLight\">\n        {formData.projectType?.id === 1\n          ? \"Subir Im√°genes del Proyecto\"\n          : \"Subir Im√°genes de la Propiedad\"}\n      </h2>\n\n      {imagesTypes.map((type) => (\n        <ImageUploadSection\n          key={type.name}\n          imageType={type}\n          expanded={expandedSections[type.name]}\n          images={images[type.name] || []}\n          tags={imageTags[type.name] || []}\n          descriptions={imageDescriptions[type.name] || []}\n          error={errors[type.name] || null}\n          errors={useMemo(\n            () =>\n              Object.fromEntries(\n                Object.entries(errors).filter(([key]) =>\n                  key.startsWith(`${type.name}-`)\n                )\n              ),\n            [errors]\n          )}\n          onToggleExpand={() => toggleSection(type.name)}\n          onImageChange={(e) =>\n            handleImageChange(type.name, e, type.maxImagesAllowed)\n          }\n          onRemoveImage={(index) => handleRemoveImage(type.name, index)}\n          onTagChange={(index, newTag) =>\n            handleTagChange(type.name, index, newTag)\n          }\n          onDescriptionChange={(index, newDescription) =>\n            handleDescriptionChange(type.name, index, newDescription)\n          }\n        />\n      ))}\n\n      {formData.commonAreas && formData.commonAreas.length > 0 && (\n        <h3 className=\"my-6 text-center text-xl font-bold text-premium-primary dark:text-premium-primaryLight\">\n          Subir im√°genes de las √°reas comunes\n        </h3>\n      )}\n\n      {formData.commonAreas?.map((area) => (\n        <ImageUploadSection\n          key={area.name}\n          imageType={{\n            id: area.id,\n            name: area.name,\n            maxImagesAllowed: 5,\n            isRequired: true,\n          }}\n          expanded={expandedSections[area.name] || false}\n          images={images[area.name] || []}\n          tags={imageTags[area.name] || []}\n          descriptions={imageDescriptions[area.name] || []}\n          error={errors[area.name] || null}\n          errors={useMemo(\n            () =>\n              Object.fromEntries(\n                Object.entries(errors).filter(([key]) =>\n                  key.startsWith(`${area.name}-`)\n                )\n              ),\n            [errors]\n          )}\n          onToggleExpand={() => toggleSection(area.name)}\n          onImageChange={(e) => handleImageChange(area.name, e, 5)}\n          onRemoveImage={(index) => handleRemoveImage(area.name, index)}\n          onTagChange={(index, newTag) =>\n            handleTagChange(area.name, index, newTag)\n          }\n          onDescriptionChange={(index, newTag) =>\n            handleDescriptionChange(area.name, index, newTag)\n          }\n        />\n      ))}\n\n      <StepNavigationButtons\n        currentStep={currentStep}\n        totalSteps={totalSteps}\n        onPrevious={onPrevious}\n        onNext={handleSubmit}\n      />\n\n      <ModalAlert\n        title=\"Advertencia\"\n        message={alertMessage}\n        isOpen={showAlert}\n        onClose={() => setShowAlert(false)}\n      />\n    </div>\n  );\n}\n",
          "ImageUploadSection.tsx": "import { useEffect, useMemo, useCallback } from \"react\";\nimport { ChevronDown } from \"lucide-react\";\nimport { ImageType } from \"@/lib/definitios\";\nimport ImageWithTag from \"./ImageWithTag\";\nimport FormErrorMessage from \"../../modals/formErrorMessage\";\n\ninterface ImageUploadSectionProps {\n  imageType: ImageType;\n  expanded: boolean;\n  images: File[];\n  tags: string[];\n  descriptions: string[];\n  error: string | null;\n  errors: Record<string, string>;\n  onToggleExpand: () => void;\n  onImageChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\n  onRemoveImage: (index: number) => void;\n  onTagChange: (index: number, tag: string) => void;\n  onDescriptionChange: (index: number, description: string) => void;\n}\n\nexport default function ImageUploadSection({\n  imageType,\n  expanded,\n  images,\n  tags,\n  descriptions,\n  error,\n  errors,\n  onToggleExpand,\n  onImageChange,\n  onRemoveImage,\n  onTagChange,\n  onDescriptionChange,\n}: ImageUploadSectionProps) {\n  const handleRemoveImage = useCallback(\n    (index: number) => onRemoveImage(index),\n    [onRemoveImage]\n  );\n\n  useEffect(() => {\n    console.log(\n      `üì∏ Re-render de ImageUploadSection para ${imageType.name}, im√°genes:`,\n      images\n    );\n  }, [images]);\n\n  const handleTagChange = useCallback(\n    (index: number, newTag: string) => onTagChange(index, newTag),\n    [onTagChange]\n  );\n\n  const handleDescriptionChange = useCallback(\n    (index: number, newDescription: string) =>\n      onDescriptionChange(index, newDescription),\n    [onDescriptionChange]\n  );\n\n  const imageList = useMemo(() => {\n    console.log(`üîç Im√°genes en categor√≠a ${imageType.name}:`, images);\n\n    return images.map((file, index) => (\n      <ImageWithTag\n        key={`${imageType.name}-${index}`}\n        file={file}\n        tag={tags[index] || \"\"}\n        description={descriptions[index] || \"\"}\n        imageTypeId={imageType.id}\n        onRemove={() => handleRemoveImage(index)}\n        onTagChange={(newTag) => handleTagChange(index, newTag)}\n        onDescriptionChange={(newDescription) =>\n          handleDescriptionChange(index, newDescription)\n        }\n        error={errors[`${imageType.name}-tag-${index}`]}\n        descriptionError={errors[`${imageType.name}-description-${index}`]}\n      />\n    ));\n  }, [\n    images,\n    tags,\n    descriptions,\n    errors,\n    handleRemoveImage,\n    handleTagChange,\n    handleDescriptionChange,\n  ]);\n\n  return (\n    <div\n      className={`rounded-md pb-1 transition bg-premium-backgroundDark hover:bg-premium-background dark:bg-premium-background dark:hover:bg-premium-backgroundLight ${\n        error ? \"border border-red-500\" : \"border-none\"\n      }`}\n    >\n      <div\n        className=\"flex flex-col cursor-pointer p-4 space-y-3\"\n        onClick={onToggleExpand}\n      >\n        <div className=\"flex items-center justify-between\">\n          <h4 className=\"text-lg font-semibold text-premium-textPrimary\">\n            {imageType.name}\n          </h4>\n          <ChevronDown\n            className={`transition-transform duration-300 ${\n              expanded ? \"rotate-180\" : \"\"\n            } text-premium-textPrimary dark:text-premium-textSecondary`}\n          />\n        </div>\n\n        {imageType.description && (\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            {imageType.description}\n          </p>\n        )}\n      </div>\n\n      {expanded && (\n        <div className=\"px-4 pb-4\">\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            multiple\n            onChange={onImageChange}\n            className={`mt-2 w-full rounded-lg px-3 py-2 text-premium-textPrimary ${\n              error ? \"border-red-500\" : \"border-none\"\n            }`}\n          />\n          <p className=\"ml-2 mt-1 text-sm text-gray-600 dark:text-gray-400\">\n            {images.length} archivo(s) subido(s)\n          </p>\n\n          {error && <FormErrorMessage error={error} />}\n\n          <div className=\"mt-2 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3\">\n            {imageList}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n",
          "ImageWithTag.tsx": "import { useEffect, useState, useCallback } from \"react\";\nimport dynamic from \"next/dynamic\";\nimport { X } from \"lucide-react\";\n\nconst FormInput = dynamic(() => import(\"@/app/ui/modals/formInput\"), {\n  ssr: false,\n});\nconst FormTextArea = dynamic(() => import(\"@/app/ui/modals/formTextArea\"), {\n  ssr: false,\n});\n\ninterface ImageWithTagProps {\n  file: File;\n  tag: string;\n  description: string;\n  imageTypeId: number;\n  onRemove: () => void;\n  onTagChange: (newTag: string) => void;\n  onDescriptionChange: (newDescription: string) => void;\n  error?: string;\n  descriptionError?: string;\n}\n\nexport default function ImageWithTag({\n  file,\n  tag,\n  description,\n  imageTypeId,\n  onRemove,\n  onTagChange,\n  onDescriptionChange,\n  error,\n  descriptionError,\n}: ImageWithTagProps) {\n  const [imageUrl, setImageUrl] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!file) {\n      console.error(\"‚ùå No se recibi√≥ archivo en ImageWithTag.\");\n      return;\n    }\n\n    console.log(\"‚úÖ Archivo recibido en ImageWithTag:\", file);\n\n    const url = URL.createObjectURL(file);\n    setImageUrl(url);\n\n    return () => URL.revokeObjectURL(url);\n  }, [file]);\n\n  const handleTagChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    onTagChange(e.target.value);\n  };\n\n  const handleDescriptionChange = useCallback(\n    (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n      if (description !== e.target.value) onDescriptionChange(e.target.value);\n    },\n    [description, onDescriptionChange]\n  );\n\n  return (\n    <div className=\"relative w-full rounded-md border border-gray-300 bg-premium-backgroundLight p-3 dark:border-gray-700 dark:bg-premium-backgroundDark space-y-4\">\n      {imageUrl && (\n        <div\n          className=\"relative h-32 w-full rounded-md bg-cover bg-center\"\n          style={{ backgroundImage: `url(${imageUrl})` }}\n        >\n          <button\n            type=\"button\"\n            className=\"absolute right-2 top-2 rounded-full bg-gray-400 p-1 text-white transition hover:bg-gray-600\"\n            onClick={onRemove}\n            aria-label=\"Eliminar imagen\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n        </div>\n      )}\n\n      <FormInput\n        label=\"Nombre de imagen\"\n        type=\"text\"\n        name=\"tag\"\n        value={tag}\n        onChange={handleTagChange}\n        placeholder=\"Nombre\"\n        maxLength={100}\n        error={error}\n        tooltipText=\"Ingrese un nombre para la imagen.\"\n      />\n\n      {imageTypeId === 1005 && (\n        <FormTextArea\n          label=\"Descripci√≥n corta\"\n          name=\"description\"\n          value={description}\n          onChange={handleDescriptionChange}\n          placeholder=\"Descripci√≥n\"\n          maxLength={100}\n          error={descriptionError}\n          tooltipText=\"Ingrese una breve descripci√≥n del plano.\"\n          rows={4}\n        />\n      )}\n    </div>\n  );\n}\n",
          "projectForm.tsx": "\"use client\";\r\n\r\nimport { useEffect, useCallback, useMemo, useState } from \"react\";\r\nimport dynamic from \"next/dynamic\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { ProjectData, Media } from \"@/lib/definitios\";\r\nimport useLocations from \"@/app/hooks/useLocations\";\r\nimport useBasicMetadata from \"@/app/hooks/useBasicMetadata\";\r\nimport useImageTypes from \"@/app/hooks/useImageTypes\";\r\nimport { useProjectByName } from \"@/app/hooks/projects/useProjectByName\";\r\nimport { useUploadImages } from \"@/app/hooks/useUploadImages\";\r\nimport { useProjectApi } from \"@/app/hooks/projects/useProjectApi\";\r\nimport { useInsertProjectMedia } from \"@/app/hooks/useInsertProjectMedia\";\r\nimport ProgressBar from \"@/app/ui/projects/createEditProject/progressBar\";\r\nimport BasicProjectForm from \"@/app/ui/projects/createEditProject/basicProjectForm\";\r\nimport LocationProjectForm from \"@/app/ui/projects/createEditProject/locationProjectForm\";\r\nimport FeaturesProjectForm from \"@/app/ui/projects/createEditProject/featuresProjectForm\";\r\nimport DetailsProjectForm from \"@/app/ui/projects/createEditProject/detailsProjectForm\";\r\nimport ImagesProjectForm from \"@/app/ui/projects/createEditProject/imagesProjectForm\";\r\nimport ModalConfirmation from \"@/app/ui/modals/modalConfirmation\";\r\nimport CreateProjectSkeleton from \"@/app/ui/projects/createEditProject/skeleton/createProjectSkeleton\";\r\n\r\nconst Loader = dynamic(() => import(\"@/app/ui/loader\"), { ssr: false });\r\n\r\ninterface ProjectFormProps {\r\n  isEdit: boolean;\r\n  isProperty: boolean;\r\n  projectName?: string;\r\n}\r\n\r\nexport default function ProjectForm({\r\n  isEdit,\r\n  isProperty,\r\n  projectName,\r\n}: ProjectFormProps) {\r\n  const { project, loading: loadingProject } = useProjectByName(\r\n    projectName || \"\"\r\n  );\r\n\r\n  const [projectData, setProjectData] = useState<Partial<ProjectData>>(\r\n    isEdit ? {} : { projectType: { id: 1, name: \"Sobre Planos\" } }\r\n  );\r\n\r\n  const [imageData, setImageData] = useState<{\r\n    images: Record<string, File[]>;\r\n    imageTags: Record<string, string[]>;\r\n    imageDescriptions: Record<string, string[]>;\r\n  }>({\r\n    images: {},\r\n    imageTags: {},\r\n    imageDescriptions: {},\r\n  });\r\n\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const totalSteps = 5;\r\n  const router = useRouter();\r\n\r\n  const { locations } = useLocations();\r\n  const { metadata } = useBasicMetadata();\r\n  const { imagesTypes } = useImageTypes();\r\n  const { submitProject } = useProjectApi();\r\n  const { uploadImages } = useUploadImages();\r\n  const { insertProjectMedia } = useInsertProjectMedia();\r\n  const [loading, setLoading] = useState(false);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [mediaToSubmit, setMediaToSubmit] = useState<Media[] | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (isEdit && project) {\r\n      setProjectData(project);\r\n    }\r\n  }, [isEdit, project]);\r\n\r\n  const handleUpdateProject = useCallback(\r\n    (updatedData: Partial<ProjectData>) => {\r\n      setProjectData((prevData) => ({\r\n        ...prevData,\r\n        ...updatedData,\r\n      }));\r\n    },\r\n    []\r\n  );\r\n\r\n  const handleNextStep = useCallback(() => {\r\n    if (currentStep < totalSteps - 1) {\r\n      setCurrentStep((prevStep) => prevStep + 1);\r\n    }\r\n  }, [currentStep, totalSteps]);\r\n\r\n  const handlePreviousStep = useCallback(() => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep((prevStep) => prevStep - 1);\r\n    }\r\n  }, [currentStep]);\r\n\r\n  const handleSubmit = useCallback(\r\n    (data: Partial<ProjectData>) => {\r\n      handleUpdateProject(data);\r\n      handleNextStep();\r\n    },\r\n    [handleUpdateProject, handleNextStep]\r\n  );\r\n\r\n  const handleFinalSubmit = async (media: Media[]) => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const result = await submitProject(\r\n        projectData,\r\n        isEdit ? \"edit\" : \"create\"\r\n      );\r\n\r\n      let projectId: number | null = null;\r\n\r\n      if (isEdit) {\r\n        if (!result) {\r\n          console.error(\"No se pudo actualizar el proyecto.\");\r\n          return;\r\n        }\r\n        projectId = projectData.id ?? null;\r\n      } else {\r\n        if (typeof result === \"number\") {\r\n          projectId = result;\r\n        } else {\r\n          console.error(\"No se pudo crear el proyecto.\");\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (!projectId) {\r\n        console.error(\"ID de proyecto inv√°lido.\");\r\n        return;\r\n      }\r\n\r\n      const uploadResult = await uploadImages(\r\n        projectId,\r\n        media,\r\n        projectData.propertyType?.name ?? \"default\"\r\n      );\r\n\r\n      if (uploadResult) {\r\n        await insertProjectMedia(uploadResult);\r\n      } else {\r\n        throw new Error(\"Error al subir las im√°genes.\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error durante el proceso:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n      router.push(\"/admin/proyectos\");\r\n    }\r\n  };\r\n\r\n  const handleOpenModal = (media: Media[]) => {\r\n    setMediaToSubmit(media);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setMediaToSubmit(null);\r\n    setIsModalOpen(false);\r\n  };\r\n\r\n  const handleConfirmSubmit = () => {\r\n    if (mediaToSubmit) {\r\n      handleFinalSubmit(mediaToSubmit);\r\n    }\r\n    handleCloseModal();\r\n  };\r\n\r\n  const currentForm = useMemo(() => {\r\n    if (!metadata || !locations || (loadingProject && isEdit)) {\r\n      return <CreateProjectSkeleton />;\r\n    }\r\n\r\n    return (\r\n      <>\r\n        {currentStep === 0 && (\r\n          <BasicProjectForm\r\n            formData={projectData}\r\n            onChange={handleUpdateProject}\r\n            onSubmit={handleSubmit}\r\n            onPrevious={handlePreviousStep}\r\n            onNext={handleNextStep}\r\n            propertyTypes={metadata.propertyTypes}\r\n            currentStep={currentStep}\r\n            totalSteps={totalSteps}\r\n            isProperty={isProperty}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 1 && (\r\n          <LocationProjectForm\r\n            formData={projectData}\r\n            onChange={handleUpdateProject}\r\n            onSubmit={handleSubmit}\r\n            onPrevious={handlePreviousStep}\r\n            onNext={handleNextStep}\r\n            currentStep={currentStep}\r\n            totalSteps={totalSteps}\r\n            departaments={locations.departaments}\r\n            cities={locations.cities}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 2 && (\r\n          <FeaturesProjectForm\r\n            formData={projectData}\r\n            onChange={handleUpdateProject}\r\n            onSubmit={handleSubmit}\r\n            onPrevious={handlePreviousStep}\r\n            onNext={handleNextStep}\r\n            currentStep={currentStep}\r\n            totalSteps={totalSteps}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 3 && (\r\n          <DetailsProjectForm\r\n            formData={projectData}\r\n            onChange={handleUpdateProject}\r\n            onSubmit={handleSubmit}\r\n            onPrevious={handlePreviousStep}\r\n            onNext={handleNextStep}\r\n            currentStep={currentStep}\r\n            totalSteps={totalSteps}\r\n            commonAreas={metadata.commonAreas}\r\n            nearbyServices={metadata.nearbyServices}\r\n            housingTypes={metadata.housingTypes}\r\n          />\r\n        )}\r\n\r\n        {currentStep === 4 && (\r\n          <ImagesProjectForm\r\n            formData={projectData}\r\n            onChange={handleUpdateProject}\r\n            onSubmit={handleOpenModal}\r\n            onPrevious={handlePreviousStep}\r\n            onNext={handleNextStep}\r\n            currentStep={currentStep}\r\n            totalSteps={totalSteps}\r\n            imagesTypes={imagesTypes}\r\n            imageData={imageData}\r\n            setImageData={setImageData}\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  }, [currentStep, metadata, locations, projectData]);\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6\">\r\n      {loading && <Loader size={20} />}\r\n      <h1 className=\"mb-10 mt-24 text-center text-3xl font-semibold text-premium-primary lg:mt-20 dark:text-premium-primaryLight\">\r\n        {isEdit ? \"Editar Proyecto\" : \"Agregar Proyecto\"}\r\n      </h1>\r\n\r\n      <div className=\"mx-auto mb-10 text-center\">\r\n        <ProgressBar currentStep={currentStep} />\r\n      </div>\r\n\r\n      <div className=\"mt-6 mx-auto max-w-3xl\">{currentForm}</div>\r\n\r\n      <ModalConfirmation\r\n        isOpen={isModalOpen}\r\n        onClose={handleCloseModal}\r\n        onConfirm={handleConfirmSubmit}\r\n        title=\"Confirmar Acci√≥n\"\r\n        message={\r\n          isEdit\r\n            ? \"¬øDeseas guardar los cambios?\"\r\n            : \"¬øEst√°s seguro de que quieres subir este proyecto?\"\r\n        }\r\n        confirmLabel=\"Confirmar\"\r\n        cancelLabel=\"Cancelar\"\r\n      />\r\n\r\n      <div className=\"mt-4 text-center\">\r\n        <button\r\n          className=\"rounded-md bg-premium-secondary px-4 py-2 text-white transition-colors hover:bg-premium-secondaryLight dark:bg-premium-secondaryDark dark:hover:bg-premium-secondaryLight\"\r\n          onClick={() => router.push(\"/admin/proyectos\")}\r\n        >\r\n          Volver\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"
        }
      }
    }
  }
}