{
  "app": {
    "admin": {
      "proyectos": {
        "crear-proyecto": {
          "page.tsx": "\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport useColombianLocations from \"@/app/hooks/useColombianLocations\";\r\nimport useBasicMetadata from \"@/app/hooks/useBasicMetadata\";\r\nimport useImageTypes from \"@/app/hooks/useImageTypes\";\r\nimport { useUploadImages } from \"@/app/hooks/useUploadImages\";\r\nimport { useCreateProject } from \"@/app/hooks/useCreateProject\";\r\nimport { useInsertProjectMedia } from \"@/app/hooks/useInsertProjectMedia\";\r\nimport ProgressBar from \"@/app/ui/projects/createProject/progressBar\";\r\nimport BasicProjectForm from \"@/app/ui/projects/createProject/basicProjectForm\";\r\nimport LocationProjectForm from \"@/app/ui/projects/createProject/locationProjectForm\";\r\nimport FeaturesProjectForm from \"@/app/ui/projects/createProject/featuresProjectForm\";\r\nimport DetailsProjectForm from \"@/app/ui/projects/createProject/detailsProjectForm\";\r\nimport ImagesProjectForm from \"@/app/ui/projects/createProject/imagesProjectForm\";\r\nimport Loader from \"@/app/ui/loader\";\r\nimport ModalConfirmation from \"@/app/ui/modalConfirmation\";\r\nimport CreateProjectSkeleton from \"@/app/ui/projects/createProject/skeleton/createProjectSkeleton\";\r\nimport { ProjectData, Media } from \"@/lib/definitios\";\r\nimport { AiOutlineCheckCircle } from \"react-icons/ai\";\r\n\r\nexport default function CreateProjectPage() {\r\n  const [projectData, setProjectData] = useState<Partial<ProjectData>>({});\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const totalSteps = 5;\r\n  const router = useRouter();\r\n\r\n  const locations = useColombianLocations();\r\n\r\n  const { metadata } = useBasicMetadata();\r\n  const { imagesTypes } = useImageTypes();\r\n  const { createProject } = useCreateProject();\r\n  const { uploadImages } = useUploadImages();\r\n  const { insertProjectMedia } = useInsertProjectMedia();\r\n  const [loading, setLoading] = useState(false);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [mediaToSubmit, setMediaToSubmit] = useState<Media[] | null>(null);\r\n\r\n  const handleUpdateProject = (updatedData: Partial<ProjectData>) => {\r\n    setProjectData((prevData) => ({\r\n      ...prevData,\r\n      ...updatedData,\r\n    }));\r\n  };\r\n\r\n  const handleNextStep = () => {\r\n    if (currentStep < totalSteps - 1) {\r\n      setCurrentStep((prevStep) => prevStep + 1);\r\n    }\r\n  };\r\n\r\n  const handlePreviousStep = () => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep((prevStep) => prevStep - 1);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (data: Partial<ProjectData>) => {\r\n    handleUpdateProject(data);\r\n    handleNextStep();\r\n  };\r\n\r\n  const handleFinalSubmit = async (media: Media[]) => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const projectId = await createProject(projectData);\r\n      if (!projectId) {\r\n        console.error(\"No se pudo crear la propiedad.\");\r\n        return;\r\n      }\r\n\r\n      const result = await uploadImages(\r\n        projectId,\r\n        media,\r\n        projectData.propertyType?.name ?? \"default\"\r\n      );\r\n\r\n      if (result) {\r\n        await insertProjectMedia(result);\r\n      } else {\r\n        throw new Error(\"Error al subir las imágenes.\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error durante el proceso:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n      router.push(\"/admin/proyectos\");\r\n    }\r\n  };\r\n\r\n  const handleOpenModal = (media: Media[]) => {\r\n    setMediaToSubmit(media);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setMediaToSubmit(null);\r\n    setIsModalOpen(false);\r\n  };\r\n\r\n  const handleConfirmSubmit = () => {\r\n    if (mediaToSubmit) {\r\n      handleFinalSubmit(mediaToSubmit);\r\n    }\r\n    handleCloseModal();\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6\">\r\n      {loading && <Loader message=\"Subiendo proyecto, por favor espera...\" />}\r\n      <h1 className=\"mt-24 lg:mt-20 text-3xl text-center font-semibold mb-10 text-primary dark:text-primaryLight\">\r\n        Agregar Proyecto\r\n      </h1>\r\n\r\n      <div className=\"mb-10 text-center mx-auto\">\r\n        <ProgressBar currentStep={currentStep} />\r\n      </div>\r\n\r\n      {!metadata || !locations ? (\r\n        <CreateProjectSkeleton />\r\n      ) : (\r\n        <div className=\"mt-6\">\r\n          {currentStep === 0 && metadata && (\r\n            <BasicProjectForm\r\n              formData={projectData || {}}\r\n              onChange={handleUpdateProject}\r\n              onSubmit={handleSubmit}\r\n              onPrevious={handlePreviousStep}\r\n              onNext={handleNextStep}\r\n              propertyTypes={metadata.propertyTypes}\r\n              currentStep={currentStep}\r\n              totalSteps={totalSteps}\r\n            />\r\n          )}\r\n\r\n          {currentStep === 1 && (\r\n            <LocationProjectForm\r\n              formData={projectData || {}}\r\n              onChange={handleUpdateProject}\r\n              onSubmit={handleSubmit}\r\n              onPrevious={handlePreviousStep}\r\n              onNext={handleNextStep}\r\n              currentStep={currentStep}\r\n              totalSteps={totalSteps}\r\n              locations={locations}\r\n            />\r\n          )}\r\n\r\n          {currentStep === 2 && metadata && (\r\n            <div>\r\n              <FeaturesProjectForm\r\n                formData={projectData || {}}\r\n                onChange={handleUpdateProject}\r\n                onSubmit={handleSubmit}\r\n                onPrevious={handlePreviousStep}\r\n                onNext={handleNextStep}\r\n                currentStep={currentStep}\r\n                totalSteps={totalSteps}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {currentStep === 3 && metadata && (\r\n            <div>\r\n              <DetailsProjectForm\r\n                formData={projectData || {}}\r\n                onChange={handleUpdateProject}\r\n                onSubmit={handleSubmit}\r\n                onPrevious={handlePreviousStep}\r\n                onNext={handleNextStep}\r\n                currentStep={currentStep}\r\n                totalSteps={totalSteps}\r\n                commonAreas={metadata.commonAreas}\r\n                nearbyServices={metadata.nearbyServices}\r\n                housingTypes={metadata.housingTypes}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {currentStep === 4 && (\r\n            <div>\r\n              <ImagesProjectForm\r\n                formData={projectData}\r\n                onChange={handleUpdateProject}\r\n                onSubmit={handleOpenModal}\r\n                onPrevious={handlePreviousStep}\r\n                onNext={handleNextStep}\r\n                currentStep={currentStep}\r\n                totalSteps={totalSteps}\r\n                imagesTypes={imagesTypes}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <ModalConfirmation\r\n        isOpen={isModalOpen}\r\n        onClose={handleCloseModal}\r\n        onConfirm={handleConfirmSubmit}\r\n        icon={<AiOutlineCheckCircle className=\"w-10 h-10 text-primary\" />}\r\n        title=\"Confirmar Acción\"\r\n        message=\"¿Estás seguro de que quieres subir este proyecto? Una vez confirmado, no podrás realizar más cambios.\"\r\n        confirmLabel=\"Confirmar\"\r\n        cancelLabel=\"Cancelar\"\r\n      />\r\n\r\n      <div className=\"text-center mt-4\">\r\n        <button\r\n          className=\"bg-secondary text-white px-4 py-2 rounded-md hover:bg-secondaryLight transition-colors dark:bg-secondaryDark dark:hover:bg-secondaryLight\"\r\n          onClick={() => router.push(\"/admin/propiedades\")}\r\n        >\r\n          Volver\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"
        }
      }
    },
    "ui": {
      "modalConfirmation.tsx": "import React, { useEffect } from \"react\";\r\nimport { AiOutlineClose } from \"react-icons/ai\";\r\n\r\ntype ModalConfirmationProps = {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onConfirm: () => void;\r\n  icon: React.ReactNode;\r\n  title: string;\r\n  message: string;\r\n  confirmLabel?: string;\r\n  cancelLabel?: string;\r\n};\r\n\r\nexport default function ModalConfirmation({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  icon,\r\n  title,\r\n  message,\r\n  confirmLabel = \"Confirmar\",\r\n  cancelLabel = \"Cancelar\",\r\n}: ModalConfirmationProps) {\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      document.body.style.overflow = \"hidden\";\r\n    } else {\r\n      document.body.style.overflow = \"auto\";\r\n    }\r\n    return () => {\r\n      document.body.style.overflow = \"auto\";\r\n    };\r\n  }, [isOpen]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\r\n      <div className=\"relative bg-backgroundAlt dark:bg-backgroundDarkAlt rounded-lg shadow-lg p-6 max-w-sm w-full\">\r\n        {/* Close Icon */}\r\n        <button\r\n          className=\"absolute top-3 right-3 text-textPrimary dark:text-textSecondary hover:text-primary dark:hover:text-primaryLight\"\r\n          onClick={onClose}\r\n          aria-label=\"Close modal\"\r\n        >\r\n          <AiOutlineClose className=\"w-5 h-5\" />\r\n        </button>\r\n\r\n        {/* Icon */}\r\n        <div className=\"flex justify-center mb-4 text-primary dark:text-primaryLight\">\r\n          {icon}\r\n        </div>\r\n\r\n        {/* Title */}\r\n        <h3 className=\"text-lg font-semibold text-textPrimary dark:text-textSecondary text-center mb-2\">\r\n          {title}\r\n        </h3>\r\n\r\n        {/* Message */}\r\n        <p className=\"text-sm text-textSecondary dark:text-gray-400 text-center mb-6\">\r\n          {message}\r\n        </p>\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex justify-center gap-4\">\r\n          <button\r\n            className=\"px-4 py-2 rounded-md bg-secondary dark:bg-secondaryDark text-white hover:bg-secondaryLight dark:hover:bg-secondary hover:opacity-90 transition\"\r\n            onClick={onClose}\r\n          >\r\n            {cancelLabel}\r\n          </button>\r\n\r\n          <button\r\n            className=\"px-4 py-2 rounded-md bg-primary dark:bg-primary text-white hover:bg-primaryDark dark:hover:bg-primaryDark transition\"\r\n            onClick={onConfirm}\r\n          >\r\n            {confirmLabel}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n",
      "projects": {
        "createProject": {
          "imagesProjectForm.tsx": "\"use client\";\r\n\r\nimport { useState, ChangeEvent, useEffect } from \"react\";\r\nimport { ProjectData, ImageType, Media } from \"@/lib/definitios\";\r\nimport ImageUploadSection from \"./ImageUploadSection\";\r\nimport StepNavigationButtons from \"../../stepNavigationButtons\";\r\nimport ModalAlert from \"../../modalAlert\";\r\n\r\ntype UploadImagesFormProps = {\r\n  formData: ProjectData;\r\n  onChange: (updatedData: Partial<ProjectData>) => void;\r\n  onPrevious: () => void;\r\n  onNext: () => void;\r\n  currentStep: number;\r\n  totalSteps: number;\r\n  imagesTypes: ImageType[];\r\n  onSubmit: (media: Media[]) => void;\r\n};\r\n\r\nexport default function ImagesProjectForm({\r\n  formData,\r\n  onPrevious,\r\n  onNext,\r\n  currentStep,\r\n  totalSteps,\r\n  imagesTypes,\r\n  onSubmit,\r\n}: UploadImagesFormProps) {\r\n  const [images, setImages] = useState<Record<string, File[]>>({});\r\n  const [imageDescriptions, setImageDescriptions] = useState<\r\n    Record<string, string[]>\r\n  >({});\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n  const [expandedSections, setExpandedSections] = useState<\r\n    Record<string, boolean>\r\n  >({});\r\n  const [imageTags, setImageTags] = useState<Record<string, string[]>>({});\r\n  const [showAlert, setShowAlert] = useState(false);\r\n  const [alertMessage, setAlertMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const initialExpandedState: Record<string, boolean> = {};\r\n    [...imagesTypes, ...(formData.commonAreas || [])].forEach((item) => {\r\n      initialExpandedState[item.name] = false;\r\n    });\r\n    setExpandedSections(initialExpandedState);\r\n  }, [imagesTypes, formData]);\r\n\r\n  const toggleSection = (category: string) => {\r\n    setExpandedSections((prev) => ({\r\n      ...prev,\r\n      [category]: !prev[category],\r\n    }));\r\n  };\r\n\r\n  const handleImageChange = (\r\n    category: string,\r\n    event: ChangeEvent<HTMLInputElement>,\r\n    maxImages: number\r\n  ) => {\r\n    const maxFileSize = 3 * 1024 * 1024;\r\n    const selectedFiles = Array.from(event.target.files || []);\r\n    const validFiles: File[] = [];\r\n    const invalidFiles: File[] = [];\r\n\r\n    selectedFiles.forEach((file) => {\r\n      if (file.size <= maxFileSize) {\r\n        validFiles.push(file);\r\n      } else {\r\n        invalidFiles.push(file);\r\n      }\r\n    });\r\n\r\n    if (invalidFiles.length > 0) {\r\n      setAlertMessage(\r\n        \"Algunas imágenes superan el límite de tamaño de 3MB y no se cargarán.\"\r\n      );\r\n      setShowAlert(true);\r\n    }\r\n\r\n    const currentImages = images[category] || [];\r\n    const currentDescriptions = imageDescriptions[category] || [];\r\n\r\n    if (currentImages.length + validFiles.length > maxImages) {\r\n      setErrors((prev) => ({\r\n        ...prev,\r\n        [category]: `Máximo ${maxImages} imágenes permitidas para esta categoría.`,\r\n      }));\r\n      return;\r\n    }\r\n\r\n    setImages((prev) => ({\r\n      ...prev,\r\n      [category]: [...currentImages, ...validFiles],\r\n    }));\r\n    setErrors((prev) => ({ ...prev, [category]: \"\" }));\r\n\r\n    setImageTags((prev) => ({\r\n      ...prev,\r\n      [category]: [...(prev[category] || []), ...validFiles.map(() => \"\")],\r\n    }));\r\n\r\n    setImageDescriptions((prev) => ({\r\n      ...prev,\r\n      [category]: [\r\n        ...currentDescriptions,\r\n        ...validFiles.map(() => \"\"), // Descripciones inicializadas en vacío\r\n      ],\r\n    }));\r\n\r\n    event.target.value = \"\"; // Resetear el input para permitir nuevas selecciones\r\n  };\r\n\r\n  const handleRemoveImage = (category: string, index: number) => {\r\n    const updatedImages = [...(images[category] || [])];\r\n    updatedImages.splice(index, 1);\r\n\r\n    const updatedTags = [...(imageTags[category] || [])];\r\n    updatedTags.splice(index, 1);\r\n\r\n    const updatedDescriptions = [...(imageDescriptions[category] || [])];\r\n    updatedDescriptions.splice(index, 1);\r\n\r\n    setImages((prev) => ({ ...prev, [category]: updatedImages }));\r\n    setImageTags((prev) => ({ ...prev, [category]: updatedTags }));\r\n    setImageDescriptions((prev) => ({\r\n      ...prev,\r\n      [category]: updatedDescriptions,\r\n    }));\r\n  };\r\n\r\n  const handleDescriptionChange = (\r\n    category: string,\r\n    index: number,\r\n    description: string\r\n  ) => {\r\n    setImageDescriptions((prev) => {\r\n      const updatedDescriptions = [...(prev[category] || [])];\r\n      updatedDescriptions[index] = description;\r\n      return {\r\n        ...prev,\r\n        [category]: updatedDescriptions,\r\n      };\r\n    });\r\n\r\n    if (description.length > 150) {\r\n      setErrors((prev) => ({\r\n        ...prev,\r\n        [`${category}-description`]:\r\n          \"La descripción no puede superar los 150 caracteres.\",\r\n      }));\r\n    } else {\r\n      setErrors((prev) => ({\r\n        ...prev,\r\n        [`${category}-description`]: \"\",\r\n      }));\r\n    }\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    imagesTypes\r\n      .filter((type) => type.isRequired)\r\n      .forEach((item) => {\r\n        if (!images[item.name] || images[item.name].length === 0) {\r\n          newErrors[\r\n            item.name\r\n          ] = `Debe subir al menos una imagen para ${item.name}.`;\r\n        }\r\n      });\r\n\r\n    formData.commonAreas?.forEach((area) => {\r\n      if (!images[area.name] || images[area.name].length === 0) {\r\n        newErrors[\r\n          area.name\r\n        ] = `Debe subir al menos una imagen para ${area.name}.`;\r\n      }\r\n    });\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const transformImagesToMedia = (): Media[] => {\r\n    const mediaArray: Media[] = [];\r\n\r\n    Object.entries(images).forEach(([type, files]) => {\r\n      const imageType = imagesTypes.find((imgType) => imgType.name === type);\r\n      const commonArea = formData.commonAreas?.find(\r\n        (area) => area.name === type\r\n      );\r\n\r\n      files.forEach((file, index) => {\r\n        mediaArray.push({\r\n          tag: imageTags[type][index] || \"\",\r\n          file,\r\n          description: imageDescriptions[type]?.[index] || \"\",\r\n          idType: imageType ? imageType.id : commonArea?.id || 0,\r\n          type: type,\r\n          category: imageType ? \"imageType\" : \"commonArea\",\r\n        });\r\n      });\r\n    });\r\n\r\n    return mediaArray;\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    if (validateForm()) {\r\n      const mediaData = transformImagesToMedia();\r\n      onSubmit(mediaData);\r\n      onNext();\r\n    }\r\n  };\r\n\r\n  const handleTagChange = (category: string, index: number, tag: string) => {\r\n    setImageTags((prev) => {\r\n      const updatedTags = { ...prev };\r\n      const categoryTags = [...(updatedTags[category] || [])];\r\n      categoryTags[index] = tag;\r\n      updatedTags[category] = categoryTags;\r\n      return updatedTags;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto max-w-2xl p-6 bg-backgroundLight dark:bg-backgroundDark rounded-lg shadow-lg\">\r\n      <h2 className=\"text-2xl font-bold text-primary dark:text-primaryLight text-center mb-6\">\r\n        Subir Imágenes del Proyecto\r\n      </h2>\r\n\r\n      <form\r\n        onSubmit={(e) => {\r\n          e.preventDefault();\r\n        }}\r\n        className=\"space-y-6\"\r\n      >\r\n        {imagesTypes.map((type) => (\r\n          <ImageUploadSection\r\n            imageType={type}\r\n            expanded={expandedSections[type.name]}\r\n            images={images[type.name] || []}\r\n            tags={imageTags[type.name] || []}\r\n            descriptions={imageDescriptions[type.name] || []}\r\n            error={errors[type.name] || null}\r\n            onToggleExpand={() => toggleSection(type.name)}\r\n            onImageChange={(e) =>\r\n              handleImageChange(type.name, e, type.maxImagesAllowed)\r\n            }\r\n            onRemoveImage={(index) => handleRemoveImage(type.name, index)}\r\n            onTagChange={(index, newTag) =>\r\n              handleTagChange(type.name, index, newTag)\r\n            }\r\n            onDescriptionChange={(index, newDescription) =>\r\n              handleDescriptionChange(type.name, index, newDescription)\r\n            }\r\n          />\r\n        ))}\r\n\r\n        <StepNavigationButtons\r\n          currentStep={currentStep}\r\n          totalSteps={totalSteps}\r\n          onPrevious={onPrevious}\r\n          onNext={handleSubmit}\r\n        />\r\n      </form>\r\n\r\n      <ModalAlert\r\n        title=\"Advertencia\"\r\n        message={alertMessage}\r\n        isOpen={showAlert}\r\n        onClose={() => setShowAlert(false)}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n",
          "ImageUploadSection.tsx": "import { AiOutlineDown, AiOutlineExclamationCircle } from \"react-icons/ai\";\r\nimport ImageWithTag from \"./ImageWithTag\";\r\nimport { ImageType } from \"@/lib/definitios\";\r\n\r\ntype ImageUploadSectionProps = {\r\n  imageType: ImageType;\r\n  expanded: boolean;\r\n  images: File[];\r\n  tags: string[];\r\n  descriptions: string[];\r\n  error: string | null;\r\n  onToggleExpand: () => void;\r\n  onImageChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\r\n  onRemoveImage: (index: number) => void;\r\n  onTagChange: (index: number, tag: string) => void;\r\n  onDescriptionChange: (index: number, description: string) => void;\r\n};\r\n\r\nexport default function ImageUploadSection({\r\n  imageType,\r\n  expanded,\r\n  images,\r\n  tags,\r\n  descriptions,\r\n  error,\r\n  onToggleExpand,\r\n  onImageChange,\r\n  onRemoveImage,\r\n  onTagChange,\r\n  onDescriptionChange,\r\n}: ImageUploadSectionProps) {\r\n  return (\r\n    <div\r\n      className={`pb-1 rounded-md bg-backgroundAlt dark:bg-backgroundDarkAlt hover:bg-backgroundLight hover:dark:bg-backgroundLight ${\r\n        error ? \"border border-red-500\" : \"border-none\"\r\n      }`}\r\n    >\r\n      <div\r\n        className=\"flex justify-between items-center cursor-pointer p-4\"\r\n        onClick={onToggleExpand}\r\n      >\r\n        <h4 className=\"text-lg font-semibold text-textPrimary\">\r\n          {imageType.name}\r\n        </h4>\r\n        <AiOutlineDown\r\n          className={`${\r\n            expanded ? \"rotate-180\" : \"\"\r\n          } transition-transform duration-300 text-textPrimary dark:text-textSecondary`}\r\n        />\r\n      </div>\r\n\r\n      {imageType.description && (\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 -mt-3 mb-4 px-4 cursor-pointer\">\r\n          {imageType.description}\r\n        </p>\r\n      )}\r\n\r\n      {expanded && (\r\n        <div className=\"px-4 pb-4\">\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            multiple\r\n            onChange={onImageChange}\r\n            className={`w-full px-3 py-2 rounded-lg bg-backgroundDark dark:bg-background text-textPrimary mt-2 ${\r\n              error ? \"border-red-500\" : \"border-none\"\r\n            }`}\r\n          />\r\n          <p className=\"mt-1 ml-2 text-sm text-gray-600 dark:text-gray-400\">\r\n            {images.length} archivo(s) subido(s)\r\n          </p>\r\n\r\n          {error && (\r\n            <div className=\"text-red-500 text-xs flex items-center gap-2 mt-1\">\r\n              <AiOutlineExclamationCircle className=\"w-5 h-5\" />\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex flex-wrap mt-2\">\r\n            {images.map((file, index) => (\r\n              <ImageWithTag\r\n                key={index}\r\n                file={file}\r\n                tag={tags[index] || \"\"}\r\n                description={descriptions[index] || \"\"}\r\n                imageTypeId={imageType.id}\r\n                onRemove={() => onRemoveImage(index)}\r\n                onTagChange={(newTag) => onTagChange(index, newTag)}\r\n                onDescriptionChange={(newDescription) =>\r\n                  onDescriptionChange(index, newDescription)\r\n                }\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n",
          "ImageWithTag.tsx": "import { ChangeEvent, useMemo } from \"react\";\r\nimport { AiOutlineClose } from \"react-icons/ai\";\r\n\r\ntype ImageWithTagProps = {\r\n  file: File;\r\n  tag: string;\r\n  description: string;\r\n  imageTypeId: number;\r\n  onRemove: () => void;\r\n  onTagChange: (newTag: string) => void;\r\n  onDescriptionChange: (newDescription: string) => void;\r\n  error?: boolean;\r\n  showError?: boolean;\r\n};\r\n\r\nexport default function ImageWithTag({\r\n  file,\r\n  tag,\r\n  description,\r\n  imageTypeId,\r\n  onRemove,\r\n  onTagChange,\r\n  onDescriptionChange,\r\n  error,\r\n  showError = false,\r\n}: ImageWithTagProps) {\r\n  const imageUrl = useMemo(() => URL.createObjectURL(file), [file]);\r\n\r\n  const handleTagChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    onTagChange(e.target.value);\r\n  };\r\n\r\n  const handleDescriptionChange = (e: ChangeEvent<HTMLTextAreaElement>) => {\r\n    onDescriptionChange(e.target.value);\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative bg-backgroundLight dark:bg-backgroundDark border border-gray-300 dark:border-gray-700 rounded-md p-3 w-48\">\r\n      <div\r\n        className=\"relative w-full h-32 bg-cover bg-center rounded-md mb-4\"\r\n        style={{\r\n          backgroundImage: `url(${imageUrl})`,\r\n        }}\r\n      >\r\n        <button\r\n          type=\"button\"\r\n          className=\"absolute top-2 right-2 bg-gray-400 text-white rounded-full p-1 hover:bg-gray-600 transition\"\r\n          onClick={onRemove}\r\n          aria-label=\"Eliminar imagen\"\r\n        >\r\n          <AiOutlineClose className=\"w-4 h-4\" />\r\n        </button>\r\n      </div>\r\n\r\n      <label className=\"block text-sm font-medium text-textPrimary dark:text-textSecondary mb-2\">\r\n        Nombre de imagen\r\n      </label>\r\n      <input\r\n        type=\"text\"\r\n        value={tag}\r\n        onChange={handleTagChange}\r\n        placeholder=\"Nombre\"\r\n        maxLength={50}\r\n        aria-invalid={!!error}\r\n        className={`w-full px-3 py-2 text-sm border rounded-md bg-white dark:bg-backgroundLight text-textPrimary dark:text-textPrimary focus:outline-none focus:ring-2 focus:ring-primary ${\r\n          error && showError\r\n            ? \"border-red-500 focus:ring-red-500\"\r\n            : \"border-gray-300\"\r\n        }`}\r\n      />\r\n      {error && showError && (\r\n        <p className=\"text-red-500 text-xs mt-2\">Etiqueta obligatoria.</p>\r\n      )}\r\n\r\n      {imageTypeId === 1005 && (\r\n        <>\r\n          <label className=\"block text-sm font-medium text-textPrimary dark:text-textSecondary mt-4 mb-2\">\r\n            Descripción corta\r\n          </label>\r\n          <textarea\r\n            value={description}\r\n            onChange={handleDescriptionChange}\r\n            placeholder=\"Descripción\"\r\n            maxLength={100}\r\n            className=\"w-full h-20 px-3 py-2 text-sm border rounded-md bg-white dark:bg-backgroundLight text-textPrimary dark:text-textPrimary focus:outline-none focus:ring-2 focus:ring-primary resize-none\"\r\n          />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"
        }
      }
    }
  }
}